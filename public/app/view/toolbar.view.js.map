{"version":3,"sources":["../src/ts/app/view/toolbar.view.ts"],"names":[],"mappings":"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","file":"toolbar.view.js","sourcesContent":["import { \r\n    Component,\r\n    OnInit,\r\n    Input,\r\n    EventEmitter,\r\n    Output\r\n} from '@angular/core';\r\nimport { BrowserModule } from '@angular/platform-browser';\r\nimport { FormsModule } from '@angular/forms';\r\nimport 'rxjs/Subject';\r\nimport { Subject } from 'rxjs/Subject';\r\nimport { Router, RoutesRecognized } from '@angular/router';\r\n\r\nimport { AppComponent } from '../component/app.component';\r\n\r\nimport { UserService } from \"../service/user.service\";\r\n\r\nexport class Tool {\r\n    icon: string;\r\n    name: string;\r\n    text: string;\r\n    active?: boolean = false;\r\n    permission?: string;\r\n}\r\n\r\nexport class SearchResult {\r\n    text: string;\r\n    type: string;\r\n    id?: number;\r\n}\r\n\r\n@Component({\r\n    moduleId: module.id,\r\n    selector: '.toolbar',\r\n    templateUrl: '../template/view/toolbar.view.html'\r\n})\r\nexport class ToolbarView implements OnInit {\r\n\r\n    @Input() title: string = \"\";\r\n\r\n    @Input() tools: Tool[] = [];\r\n    allowedTools: Tool[] = [];\r\n\r\n    @Input() showBack: boolean = false;\r\n\r\n    @Input() showFilterClear: boolean = false;\r\n\r\n    @Input() showSearch: boolean = false;\r\n    @Input() searchResults: SearchResult[] = [];\r\n\r\n    @Output() toolClicked: EventEmitter<Tool> = new EventEmitter();\r\n    @Output() goBack = new EventEmitter();\r\n    @Output() search: EventEmitter<string> = new EventEmitter();\r\n    @Output() searchResultClick: EventEmitter<SearchResult> = new EventEmitter();\r\n\r\n    searchOpen: boolean = false;\r\n    searchActive: boolean = false;\r\n    searchTerm: string;\r\n\r\n    constructor(\r\n        private _app: AppComponent,\r\n        private router: Router,\r\n        private userService: UserService\r\n    ) {\r\n        /* I won't use this, but here is how to subscribe to router events!\r\n        // when changing route, reset the toolbar\r\n        router.events.subscribe(val => {\r\n            if (val instanceof RoutesRecognized) {\r\n                this.setTitle(\"\");\r\n                this.setTools([]);\r\n            }\r\n        })\r\n        */\r\n\r\n        // TODO: pre-populate results with history and favorites\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        let perms = this.userService.getPermissions();\r\n        this.tools.forEach(tool => {\r\n            if (!tool.permission || perms[tool.permission]) {\r\n                this.allowedTools.push(tool);\r\n            }\r\n        });\r\n    }\r\n    \r\n    setTitle(title: string): void {\r\n        this.title = title;\r\n    }\r\n\r\n    setTools(tools: Tool[]): void {\r\n        this.tools = tools;\r\n    }\r\n\r\n    toolClick(tool: Tool): void {\r\n        this.toolClicked.emit(tool);\r\n    }\r\n\r\n    toggleNav(): void {\r\n        this._app.toggleNav();\r\n    }\r\n\r\n    back(): void {\r\n        if (this.searchActive) {\r\n            this.clearSearch();\r\n        } else {\r\n            this.goBack.emit();\r\n        }\r\n    }\r\n\r\n    openSearch(): void {\r\n        this.searchOpen = true;\r\n    }\r\n\r\n    closeSearch(): void {\r\n        this.searchOpen = false;\r\n    }\r\n\r\n    clearSearch(): void {\r\n        if (this.searchActive) {\r\n            this.searchResultClick.emit({\r\n                \"type\": \"search\",\r\n                \"text\": \"\"\r\n            });\r\n        }\r\n        this.searchTerm = \"\";\r\n        this.searchActive = false;\r\n        this.closeSearch();\r\n    }\r\n\r\n    private _typeDebounce;\r\n    typeSearch(event): void {\r\n        if (event.keyCode == 13) {\r\n            this.searchResultClick.emit({\r\n                \"type\": \"search\",\r\n                \"text\": this.searchTerm\r\n            });\r\n            this.searchActive = true;\r\n        } else {\r\n            clearTimeout(this._typeDebounce);\r\n            this._typeDebounce = setTimeout(() => {\r\n                this.search.emit(this.searchTerm);\r\n            }, 300);\r\n        }\r\n    }\r\n\r\n    clickResult(result: SearchResult): void {\r\n        this.searchResultClick.emit(result);\r\n        this.clearSearch();\r\n    }\r\n\r\n}"]}